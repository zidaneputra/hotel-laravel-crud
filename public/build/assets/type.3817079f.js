$(function(){if(!window.location.pathname.startsWith("/type"))return;const o=$("#type-table").DataTable({processing:!0,serverSide:!0,ajax:{url:"/type",type:"GET",error:function(e,t,n){}},columns:[{name:"number",data:"number"},{name:"name",data:"name"},{name:"information",data:"information"},{name:"id",data:"id",width:"100px",render:function(e){return`
                        <button class="btn btn-light btn-sm rounded shadow-sm border"
                            data-action="edit-type" data-type-id="${e}"
                            data-bs-toggle="tooltip" data-bs-placement="top" title="Edit type">
                            <i class="fas fa-edit"></i>
                        </button>
                        <form class="btn btn-sm delete-type" method="POST"
                            id="delete-type-form-${e}"
                            action="/type/${e}">
                            <input type="hidden" name="_method" value="DELETE">
                            <a class="btn btn-light btn-sm rounded shadow-sm border delete"
                                href="#" type-id="${e}" type-role="type" data-bs-toggle="tooltip"
                                data-bs-placement="top" title="Delete type">
                                <i class="fas fa-trash-alt"></i>
                            </a>
                        </form>

                    `}}]}),a=new bootstrap.Modal($("#main-modal"),{backdrop:!0,keyboard:!0,focus:!0});$(document).on("click",".delete",function(){var e=$(this).attr("type-id");$(this).attr("type-name"),$(this).attr("type-url"),Swal.mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1}).fire({title:"Are you sure?",text:"Type will be deleted, You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel! ",reverseButtons:!0}).then(n=>{n.isConfirmed&&$(`#delete-type-form-${e}`).submit()})}).on("click","#add-button",async function(){a.show(),$("#main-modal .modal-body").html("Fetching data");const e=await $.get("/type/create");!e||($("#main-modal .modal-title").text("Create new type"),$("#main-modal .modal-body").html(e.view),$(".select2").select2())}).on("click","#btn-modal-save",function(){$("#form-save-type").submit()}).on("submit","#form-save-type",async function(e){e.preventDefault(),CustomHelper.clearError(),$("#btn-modal-save").attr("disabled",!0);try{const t=await $.ajax({url:$(this).attr("action"),data:$(this).serialize(),method:$(this).attr("method"),headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});if(!t)return;Swal.fire({position:"top-end",icon:"success",title:t.message,showConfirmButton:!1,timer:1500}),a.hide(),o.ajax.reload()}catch(t){t.status===422&&(console.log(t),Swal.fire({icon:"error",title:"Oops...",text:t.responseJSON.message}),CustomHelper.errorHandlerForm(t))}finally{$("#btn-modal-save").attr("disabled",!1)}}).on("click",'[data-action="edit-type"]',async function(){a.show(),$("#main-modal .modal-body").html("Fetching data");const e=$(this).data("type-id"),t=await $.get(`/type/${e}/edit`);!t||($("#main-modal .modal-title").text("Edit type"),$("#main-modal .modal-body").html(t.view),$(".select2").select2())}).on("submit",".delete-type",async function(e){e.preventDefault();try{const t=await $.ajax({url:$(this).attr("action"),data:$(this).serialize(),method:$(this).attr("method"),headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});if(!t)return;Swal.fire({position:"top-end",icon:"success",title:t.message,showConfirmButton:!1,timer:1500}),o.ajax.reload()}catch(t){t&&t.responseJSON&&t.responseJSON.message&&Swal.fire({position:"top-end",icon:"error",title:t.responseJSON.message,showConfirmButton:!1,timer:1500})}})});
